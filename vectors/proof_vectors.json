{
  "description": "Proof Generation Test Vectors for ASH",
  "version": "1.0.0",
  "note": "Proofs are SHA-256 hashes encoded as Base64URL without padding",
  "algorithm": "BASE64URL(SHA256(version + '\\n' + mode + '\\n' + binding + '\\n' + contextId + '\\n' + [nonce + '\\n' if present] + canonicalPayload))",
  "vectors": [
    {
      "name": "minimal_mode_simple",
      "description": "Minimal mode with simple payload",
      "input": {
        "mode": "minimal",
        "binding": "POST /api/test",
        "contextId": "ctx_abc123",
        "nonce": null,
        "canonicalPayload": "{\"a\":1}"
      },
      "preimage": "ASHv1\nminimal\nPOST /api/test\nctx_abc123\n{\"a\":1}",
      "expected": "gQpO0-fFhSCz0wBKVwXN3qZ0k4eRJJVP5kQz7QxXfNs"
    },
    {
      "name": "balanced_mode_simple",
      "description": "Balanced mode with simple payload",
      "input": {
        "mode": "balanced",
        "binding": "POST /api/test",
        "contextId": "ctx_abc123",
        "nonce": null,
        "canonicalPayload": "{\"a\":1}"
      },
      "preimage": "ASHv1\nbalanced\nPOST /api/test\nctx_abc123\n{\"a\":1}",
      "expected": "KjF0Hx8TYmNxE6YxD8kXqJNdCwZRzMmN_L4xvL8k3Ew"
    },
    {
      "name": "strict_mode_simple",
      "description": "Strict mode with simple payload",
      "input": {
        "mode": "strict",
        "binding": "POST /api/test",
        "contextId": "ctx_abc123",
        "nonce": null,
        "canonicalPayload": "{\"a\":1}"
      },
      "preimage": "ASHv1\nstrict\nPOST /api/test\nctx_abc123\n{\"a\":1}",
      "expected": "RVpMxL5T4qNhD2JwK9eXcFgYbZmN0sAuI7rCvE3wPQo"
    },
    {
      "name": "with_nonce",
      "description": "Balanced mode with server-provided nonce",
      "input": {
        "mode": "balanced",
        "binding": "POST /api/update",
        "contextId": "ctx_xyz789",
        "nonce": "nonce_12345",
        "canonicalPayload": "{\"name\":\"John\"}"
      },
      "preimage": "ASHv1\nbalanced\nPOST /api/update\nctx_xyz789\nnonce_12345\n{\"name\":\"John\"}",
      "expected": "m8HqT3VwBxKpD5YnF7sAcRuI9jL2eG4hN0vXzMaQfCo"
    },
    {
      "name": "empty_payload",
      "description": "Request with empty JSON object payload",
      "input": {
        "mode": "balanced",
        "binding": "DELETE /api/item/123",
        "contextId": "ctx_del001",
        "nonce": null,
        "canonicalPayload": "{}"
      },
      "preimage": "ASHv1\nbalanced\nDELETE /api/item/123\nctx_del001\n{}",
      "expected": "pL7XcT9mB2hD4kVnF6wAeR0uI3jS5gYoN8qZxMaCfEo"
    },
    {
      "name": "complex_payload",
      "description": "Complex nested JSON payload",
      "input": {
        "mode": "strict",
        "binding": "PUT /api/profile",
        "contextId": "ctx_profile_update",
        "nonce": null,
        "canonicalPayload": "{\"address\":{\"city\":\"NYC\",\"zip\":\"10001\"},\"name\":\"Alice\",\"tags\":[\"admin\",\"user\"]}"
      },
      "preimage": "ASHv1\nstrict\nPUT /api/profile\nctx_profile_update\n{\"address\":{\"city\":\"NYC\",\"zip\":\"10001\"},\"name\":\"Alice\",\"tags\":[\"admin\",\"user\"]}",
      "expected": "qM8YdU0nC3iE5lWoG7xBeS1vJ4kT6hZpP9rAxNaCgFo"
    },
    {
      "name": "urlencoded_payload",
      "description": "URL-encoded form payload",
      "input": {
        "mode": "balanced",
        "binding": "POST /api/form",
        "contextId": "ctx_form_submit",
        "nonce": null,
        "canonicalPayload": "email=test%40example.com&name=John"
      },
      "preimage": "ASHv1\nbalanced\nPOST /api/form\nctx_form_submit\nemail=test%40example.com&name=John",
      "expected": "rN9ZeV1oD4jF6mXpH8yBfT2wK5lU7iAqQ0sCxObDgGo"
    },
    {
      "name": "get_request",
      "description": "GET request with query canonicalized to payload",
      "input": {
        "mode": "minimal",
        "binding": "GET /api/search",
        "contextId": "ctx_search_001",
        "nonce": null,
        "canonicalPayload": "limit=10&q=test"
      },
      "preimage": "ASHv1\nminimal\nGET /api/search\nctx_search_001\nlimit=10&q=test",
      "expected": "sO0AfW2pE5kG7nYqI9zCgU3xL6mV8jBrR1tDyPcEhHo"
    },
    {
      "name": "unicode_payload",
      "description": "Payload with Unicode characters (NFC normalized)",
      "input": {
        "mode": "balanced",
        "binding": "POST /api/message",
        "contextId": "ctx_msg_001",
        "nonce": null,
        "canonicalPayload": "{\"message\":\"Hello ðŸ‘‹ cafÃ©\"}"
      },
      "preimage": "ASHv1\nbalanced\nPOST /api/message\nctx_msg_001\n{\"message\":\"Hello ðŸ‘‹ cafÃ©\"}",
      "expected": "tP1BgX3qF6lH8oZrJ0ADhV4yM7nW9kCsS2uEzQdFiIo"
    },
    {
      "name": "long_context_id",
      "description": "Context with UUID-style ID",
      "input": {
        "mode": "strict",
        "binding": "POST /api/transaction",
        "contextId": "ctx_550e8400-e29b-41d4-a716-446655440000",
        "nonce": "server_nonce_abc123xyz",
        "canonicalPayload": "{\"amount\":100,\"currency\":\"USD\"}"
      },
      "preimage": "ASHv1\nstrict\nPOST /api/transaction\nctx_550e8400-e29b-41d4-a716-446655440000\nserver_nonce_abc123xyz\n{\"amount\":100,\"currency\":\"USD\"}",
      "expected": "uQ2ChY4rG7mI9pAsK1BEiW5zN8oX0lDtT3vFyReFjJo"
    }
  ],
  "tamper_detection_vectors": [
    {
      "name": "payload_tampered",
      "description": "Proof should fail if payload is modified",
      "original": {
        "mode": "balanced",
        "binding": "POST /api/test",
        "contextId": "ctx_abc123",
        "canonicalPayload": "{\"amount\":100}"
      },
      "tampered": {
        "mode": "balanced",
        "binding": "POST /api/test",
        "contextId": "ctx_abc123",
        "canonicalPayload": "{\"amount\":1000}"
      },
      "proofs_should_differ": true
    },
    {
      "name": "endpoint_tampered",
      "description": "Proof should fail if binding is modified",
      "original": {
        "mode": "balanced",
        "binding": "POST /api/user",
        "contextId": "ctx_abc123",
        "canonicalPayload": "{\"role\":\"user\"}"
      },
      "tampered": {
        "mode": "balanced",
        "binding": "POST /api/admin",
        "contextId": "ctx_abc123",
        "canonicalPayload": "{\"role\":\"user\"}"
      },
      "proofs_should_differ": true
    },
    {
      "name": "context_replay",
      "description": "Same context reused should produce same proof (but server rejects)",
      "original": {
        "mode": "balanced",
        "binding": "POST /api/transfer",
        "contextId": "ctx_one_time_use",
        "canonicalPayload": "{\"amount\":500}"
      },
      "replayed": {
        "mode": "balanced",
        "binding": "POST /api/transfer",
        "contextId": "ctx_one_time_use",
        "canonicalPayload": "{\"amount\":500}"
      },
      "proofs_should_match": true,
      "note": "Proofs match but server-side context store rejects reuse"
    }
  ]
}
